<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <link rel="icon" href="jose.ico" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Open Graph -->
  <meta property="og:title" content="Lançamentos - JSY ANIME">
  <meta property="og:image" content="https://j-s-an.github.io/anime/jose.ico">
  <meta property="og:url" content="https://bit.ly/JSY-ANIME">
  <meta property="og:type" content="website">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <meta name="google-adsense-account" content="ca-pub-8906506021952813">

  <title>Lançamentos - JSY ANIME</title>

  <style>
    body {
      background: #111;
      color: #fff;
      font-family: sans-serif;
      margin: 0;
    }

    /* Menu */
    .menu {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #1a1a1a;
      padding: 10px 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .logo {
      font-size: 20px;
      font-weight: bold;
      color: #ff4757;
    }

    .menu-links {
      display: flex;
      list-style: none;
      gap: 15px;
      margin: 0;
      padding: 0;
    }

    .menu-links li a {
      text-decoration: none;
      color: #fff;
      font-size: 14px;
      transition: color 0.3s;
    }

    .menu-links li a:hover {
      color: #1dd1a1;
    }

    .menu-toggle {
      display: none;
      font-size: 26px;
      color: #fff;
      cursor: pointer;
    }

    /* Responsivo */
    @media (max-width: 768px) {
      .menu-toggle {
        display: block;
      }

      .menu-links {
        display: none;
        flex-direction: column;
        background-color: #1a1a1a;
        position: absolute;
        top: 60px;
        right: 20px;
        width: 160px;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 0 10px #000;
      }

      .menu-links.active {
        display: flex;
      }
    }

    /* Conteúdo */
    h1 {
      text-align: center;
      color: #00ffff;
      padding: 20px 0 10px;
      margin: 0;
    }

    .episodios {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
      padding: 20px;
    }

    .card {
      background: #222;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .card:hover {
      transform: scale(1.03);
      box-shadow: 0 0 15px #00ffff;
    }

    .card img {
      width: 100%;
      height: 160px;
      object-fit: cover;
      background-color: #000;
    }

    .card-content {
      padding: 10px 12px;
    }

    .titulo {
      font-size: 15px;
      line-height: 1.4;
      color: #fff;
      margin: 0;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    #pagination {
      text-align: center;
      padding: 20px;
    }

    #pagination button {
      background: #333;
      color: #fff;
      border: none;
      padding: 6px 12px;
      margin: 2px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }

    #pagination button:hover {
      background: #00ffff;
      color: #000;
    }

    .anuncio {

      color: #00ffea;
      text-align: center;
      padding: 12px 10px;
      font-size: 15px;
      font-weight: bold;
    }

    .anuncio a {
      color: #ff0000;
      text-decoration: underline;
    }

    .footer {
      background-color: #111;
      color: #ccc;
      text-align: center;
      padding: 25px 15px;
      border-top: 2px solid #e60000;
      font-family: 'Arial', sans-serif;
    }

    .footer-apoiar {
      margin-bottom: 15px;
      font-size: 1.2em;
    }

    .footer-apoiar span {
      color: #e6b800;
      display: block;
      margin-bottom: 10px;
      font-size: 1.3em;
    }

    .botao-apoio {
      background-color: rgba(230, 184, 0, 0.6);
      color: white;
      font-weight: bold;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 1.2em;
      transition: all 0.3s ease;
    }

    .botao-apoio:hover {
      background-color: #e6b800;
      box-shadow: 0 0 10px #e6b80060;
    }

    .footer-parcerias {
      margin: 20px 0;
      font-size: 1em;
    }

    .footer-parcerias h4 {
      color: #e6b800;
      margin-bottom: 10px;
      font-size: 1.2em;
    }

    .footer-parcerias p {
      margin: 6px 0;
    }

    .footer-parcerias a {
      color: #ccc;
      text-decoration: none;
      margin: 0 5px;
      transition: color 0.3s ease;
    }

    .footer-parcerias a:hover {
      color: #e6b800;
    }

    .footer-parcerias .oficial {
      color: #00ff88;
    }

    .footer-parcerias .nao-oficial {
      color: #ff5555;
    }

    .footer-aviso {
      font-size: 0.9em;
      color: #aaa;
      margin: 15px 0;
    }

    .social-icons {
      margin: 20px 0 10px;
    }

    .social-icons a {
      color: #e6b800;
      font-size: 1.8em;
      margin: 0 10px;
      transition: transform 0.3s ease, color 0.3s ease;
    }

    .social-icons a:hover {
      color: white;
      transform: scale(1.2);
    }

    /* NOVO MENU DE LINKS */
    .footer-menu {
      margin: 10px 0 15px;
    }

    .footer-menu a {
      color: #e6b800;
      text-decoration: none;
      margin: 0 10px;
      font-weight: bold;
      font-size: 1em;
      transition: color 0.3s ease;
    }

    .footer-menu a:hover {
      color: white;
      text-decoration: underline;
    }

    .footer-versao {
      margin-top: 10px;
      font-size: 0.9em;
      color: #777;
    }
  </style>
</head>

<body>

  <!-- MENU -->
  <header>
    <nav class="menu">
      <div class="logo">JSY ANIME</div>
      <div class="menu-toggle" id="menu-toggle">&#9776;</div>
      <ul class="menu-links" id="menu-links">
        <li><a href="https://j-s-an.github.io/anime/">Início</a></li>
        <li><a href="https://j-s-an.github.io/anime/Lançamentos.html">Lançamentos</a></li>
        <li><a href="https://j-s-an.github.io/anime/lista-anime.html">Lista de Anime</a></li>
        <li><a href="https://j-s-an.github.io/anime/Pedido-de-Anime.html">Pedido de Anime</a></li>
      </ul>
    </nav>
  </header>

  <div class="anuncio">
    📢 <strong>ANIME EM LANÇAMENTO 🎬</strong> — Receba novidades no
    <a href="https://whatsapp.com/channel/0029VakjTxcG8l5DQWBcKO3O" target="_blank">WhatsApp</a> ou
    <a href="https://t.me/+khy33-_eaUsxYjgx" target="_blank">Telegram</a>
  </div>


  <!-- TÍTULO -->
  <h1>🌀 Lançamentos</h1>

  <!-- CONTEÚDO -->
  <div class="episodios" id="feed"></div>
  <div id="pagination"></div>

  <!-- SCRIPT GOOGLE SHEETS COM PAGINAÇÃO -->
  <!-- SUBSTITUA ESTE SCRIPT PELO ANTERIOR -->
  <script>
    const sheetId = '1QPSqwuXb-2De4SvQ3WuJVbQbWMtPsv3SxjTeGtpuTVo';
    const sheetName = 'lancamento';
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;

    let allRows = [];
    const itemsPerPage = 50;
    let currentPage = 1;

    function showError(msg) {
      const container = document.getElementById('feed');
      container.innerHTML = `<div style="color:#ff6b6b;padding:20px;text-align:center;background:#1b1b1b;border-radius:8px;">${msg}</div>`;
      document.getElementById('pagination').innerHTML = '';
    }

    function parseGViz(text) {
      const m = text.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\);/);
      if (m && m[1]) return JSON.parse(m[1]);
      const start = text.indexOf('(');
      const end = text.lastIndexOf(')');
      if (start !== -1 && end !== -1) return JSON.parse(text.substring(start + 1, end));
      return JSON.parse(text.substr(47).slice(0, -2));
    }

    // --- Carrega a planilha ---
    fetch(url)
      .then(res => {
        if (!res.ok) throw new Error('Resposta não OK: ' + res.status);
        return res.text();
      })
      .then(text => {
        let json;
        try {
          json = parseGViz(text);
        } catch (err) {
          console.error('Erro ao parsear JSON da planilha:', err);
          showError('Erro ao interpretar os dados da planilha. Verifique a planilha pública.');
          return;
        }

        allRows = Array.isArray(json.table?.rows) ? json.table.rows.reverse() : [];
        if (allRows.length === 0) {
          showError('Planilha carregada, mas sem linhas.');
          return;
        }
        console.log('Planilha carregada. Linhas:', allRows.length);

        // --- Lê hash na URL e renderiza a página correta ---
        const params = new URLSearchParams(window.location.hash.slice(1));
        const p = parseInt(params.get("p"), 10);
        if (!isNaN(p) && p > 0) currentPage = p;

        renderPage(currentPage);
      })
      .catch(err => {
        console.error('Erro no fetch da planilha:', err);
        showError('Erro ao carregar planilha: ' + err.message);
      });

    // --- Função para renderizar cada página ---
    function renderPage(page) {
      currentPage = page;

      const container = document.getElementById('feed');
      const pagination = document.getElementById('pagination');
      container.innerHTML = '';
      pagination.innerHTML = '';

      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageItems = allRows.slice(start, end);

      pageItems.forEach(row => {
        const foto = row.c?.[0]?.v || 'https://j-s-fo.github.io/foto/anime/0.0.webp';
        const nome = row.c?.[1]?.v || 'Sem Nome';
        const ep = row.c?.[2]?.v ?? '';
        const idioma = row.c?.[3]?.v || '';
        const link = row.c?.[4]?.v || '#';
        const final = row.c?.[5]?.v === "Final" ? "Final" : "";

        const epStr = String(ep).trim();
        let titulo = '';
        if (epStr.toLowerCase() === 'filme') {
          titulo = `${nome} - Filme ${idioma}`.trim();
        } else if (epStr === '') {
          titulo = `${nome} ${final} - ${idioma}`.trim();
        } else {
          titulo = `${nome} - Episódio ${epStr} ${final} - ${idioma}`.trim();
        }

        const card = `
      <a href="${link}" rel="noopener">
        <div class="card">
          <img src="${foto}" alt="${nome}">
          <div class="card-content">
            <p class="titulo">${titulo}</p>
          </div>
        </div>
      </a>
    `;
        container.insertAdjacentHTML('beforeend', card);
      });

      // --- Paginação ---
      const totalPages = Math.ceil(allRows.length / itemsPerPage);
      if (totalPages <= 1) return;

      const maxVisible = 6;
      let startPage = Math.max(1, page - Math.floor(maxVisible / 2));
      let endPage = startPage + maxVisible - 1;
      if (endPage > totalPages) {
        endPage = totalPages;
        startPage = Math.max(1, endPage - maxVisible + 1);
      }

      if (page > 1) pagination.insertAdjacentHTML('beforeend', `<button onclick="renderPage(${page - 1})">◀ Anterior</button>`);

      for (let i = startPage; i <= endPage; i++) {
        const style = i === page ? 'font-weight:bold;background:#00ffff;color:#000;' : '';
        pagination.insertAdjacentHTML('beforeend', `<button onclick="renderPage(${i})" style="${style}">${i}</button>`);
      }

      if (page < totalPages) pagination.insertAdjacentHTML('beforeend', `<button onclick="renderPage(${page + 1})">Próxima ▶</button>`);

      // Atualiza o hash da URL
      updateURL();

      document.querySelector('.menu').scrollIntoView({ behavior: 'smooth' });
    }

    // --- Atualiza o hash na URL ---
    function updateURL() {
      const params = new URLSearchParams();
      params.set("p", currentPage);
      window.location.hash = "#" + params.toString();
    }

    // --- Menu toggle ---
    document.getElementById("menu-toggle").onclick = () =>
      document.getElementById("menu-links").classList.toggle("active");
  </script>


  <br>
  <div id="frame" style="width: 100%;margin: auto;position: relative; z-index: 99998;">
    <iframe data-aa='2409970' src='//acceptable.a-ads.com/2409970/?size=Adaptive'
      style='border:0; padding:0; width:70%; height:auto; overflow:hidden;display: block;margin: auto'></iframe>
  </div>
  <br>

  <div>
    <!-- Exemplo de inclusão do rodapé com JavaScript -->
    <script>
      fetch('footer.html')
        .then(response => response.text())
        .then(data => {
          document.body.insertAdjacentHTML('beforeend', data);
        });
    </script>
  </div>

  <!-- ===== POPUP AVISO DE FÉRIAS ===== -->
  <style>
    .jsy-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 99999;
      padding: 20px;
    }

    .jsy-modal-overlay.active {
      display: flex;
    }

    .jsy-modal {
      width: 90%;
      max-width: 600px;
      background: #1a1a1a;
      color: #fff;
      border-radius: 12px;
      padding: 20px;
      border: 2px solid #e6b800;
      text-align: center;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.7);
    }

    .jsy-modal h3 {
      margin-top: 0;
      color: #e6b800;
    }

    .jsy-modal p {
      color: #ddd;
      margin: 10px 0 20px;
    }

    .jsy-btn {
      background: #e6b800;
      color: #111;
      border: none;
      padding: 10px 18px;
      margin: 5px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }

    .jsy-btn:hover {
      background: #ffcc00;
    }

    .jsy-btn.secondary {
      background: transparent;
      color: #fff;
      border: 1px solid #e6b800;
    }
  </style>

  <div id="jsyModalOverlay" class="jsy-modal-overlay">
    <div class="jsy-modal">
      <h3>Aviso de horário de lançamentos</h3>
      <p>Hoje não haverá lançamentos no período da manhã e da tarde <br> O ADM Está na Praia.
        Lançamentos serão feitos à noite. <br>Agradecemos pela compreensão!</p>
      <div>
        <button class="jsy-btn secondary" id="jsyCloseBtn">Fechar</button>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const DIA_AVISO = 7; // altere o dia (0=Dom, 1=Seg, ..., 6=Sáb)
      const overlay = document.getElementById('jsyModalOverlay');
      const closeBtn = document.getElementById('jsyCloseBtn');
      const dontShowBtn = document.getElementById('jsyDontShowBtn');

      function getWeekId(d) {
        const date = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
        date.setUTCDate(date.getUTCDate() + 4 - (date.getUTCDay() || 7));
        const yearStart = new Date(Date.UTC(date.getUTCFullYear(), 0, 1));
        const weekNo = Math.ceil((((date - yearStart) / 86400000) + 1) / 7);
        return `${date.getUTCFullYear()}-W${weekNo}`;
      }

      const hoje = new Date();
      const hojeDia = hoje.getDay();
      const semanaId = getWeekId(hoje);
      const key = 'jsy_aviso_week';
      const suprimido = localStorage.getItem(key);

      // Mostra apenas no dia definido e se ainda não foi suprimido
      if (hojeDia === DIA_AVISO && suprimido !== semanaId) {
        setTimeout(() => overlay.classList.add('active'), 500);
      }

      closeBtn.onclick = () => overlay.classList.remove('active');
      dontShowBtn.onclick = () => {
        localStorage.setItem(key, semanaId);
        overlay.classList.remove('active');
      };

      // Fechar com ESC
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') overlay.classList.remove('active');
      });
    })();
  </script>
  <!-- ===== FIM DO POPUP ===== -->

</body>

</html>
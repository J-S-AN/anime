<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <link rel="icon" href="jose.ico" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Open Graph -->
  <meta property="og:title" content="Lançamentos - JSY ANIME">
  <meta property="og:image" content="https://j-s-an.github.io/anime/jose.ico">
  <meta property="og:url" content="https://bit.ly/JSY-ANIME">
  <meta property="og:type" content="website">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <meta name="google-adsense-account" content="ca-pub-8906506021952813">

  <title>Lançamentos - JSY ANIME</title>

  <style>
    body {
      background: #111;
      color: #fff;
      font-family: sans-serif;
      margin: 0;
    }

    /* Menu */
    .menu {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #1a1a1a;
      padding: 10px 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .logo {
      font-size: 20px;
      font-weight: bold;
      color: #ff4757;
    }

    .menu-links {
      display: flex;
      list-style: none;
      gap: 15px;
      margin: 0;
      padding: 0;
    }

    .menu-links li a {
      text-decoration: none;
      color: #fff;
      font-size: 14px;
      transition: color 0.3s;
    }

    .menu-links li a:hover {
      color: #1dd1a1;
    }

    .menu-toggle {
      display: none;
      font-size: 26px;
      color: #fff;
      cursor: pointer;
    }

    /* Responsivo */
    @media (max-width: 768px) {
      .menu-toggle {
        display: block;
      }

      .menu-links {
        display: none;
        flex-direction: column;
        background-color: #1a1a1a;
        position: absolute;
        top: 60px;
        right: 20px;
        width: 160px;
        padding: 10px;
        border-radius: 8px;
        box-shadow: 0 0 10px #000;
      }

      .menu-links.active {
        display: flex;
      }
    }

    /* Conteúdo */
    h1 {
      text-align: center;
      color: #00ffff;
      padding: 20px 0 10px;
      margin: 0;
    }

    .episodios {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      gap: 20px;
      padding: 20px;
    }

    .card {
      background: #222;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.8);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .card:hover {
      transform: scale(1.03);
      box-shadow: 0 0 15px #00ffff;
    }

    .card img {
      width: 100%;
      height: 160px;
      object-fit: cover;
      background-color: #000;
    }

    .card-content {
      padding: 10px 12px;
    }

    .titulo {
      font-size: 15px;
      line-height: 1.4;
      color: #fff;
      margin: 0;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    #pagination {
      text-align: center;
      padding: 20px;
    }

    #pagination button {
      background: #333;
      color: #fff;
      border: none;
      padding: 6px 12px;
      margin: 2px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }

    #pagination button:hover {
      background: #00ffff;
      color: #000;
    }

    .anuncio {

      color: #00ffea;
      text-align: center;
      padding: 12px 10px;
      font-size: 15px;
      font-weight: bold;
    }

    .anuncio a {
      color: #ff0000;
      text-decoration: underline;
    }

    .footer {
      margin-top: 20px;
      padding: 20px;
      background-color: #2c2c2c;
      border-radius: 10px;
      text-align: center;
      color: #ccc;
    }

    .footer .watermark {
      font-size: 1.2em;
      margin-bottom: 10px;
      color: #ffcc00;
    }

    .footer .social-icons {
      display: flex;
      justify-content: center;
      gap: 20px;
    }

    .footer .social-icons a {
      color: #ffcc00;
      text-decoration: none;
      font-size: 1.5em;
      transition: color 0.3s ease;
    }

    .footer .social-icons a:hover {
      color: #e6b800;
    }
  </style>
</head>

<body>

  <!-- MENU -->
  <header>
    <nav class="menu">
      <div class="logo">JSY ANIME</div>
      <div class="menu-toggle" id="menu-toggle">&#9776;</div>
      <ul class="menu-links" id="menu-links">
        <li><a href="https://j-s-an.github.io/anime/">Início</a></li>
        <li><a href="https://j-s-an.github.io/anime/Lançamentos.html">Lançamentos</a></li>
        <li><a href="https://j-s-an.github.io/anime/em-breve.html">Em Breve</a></li>
        <li><a href="https://j-s-an.github.io/anime/lista-anime.html">Lista de Anime</a></li>
        <li><a href="https://j-s-an.github.io/anime/Pedido-de-Anime.html">Pedido de Anime</a></li>
        <li><a href="https://forms.gle/9xpodxVW71nXcjAG9">Contato</a></li>
      </ul>
    </nav>
  </header>

  <div class="anuncio">
    📢 <strong>ANIME EM LANÇAMENTO 🎬</strong> — Receba novidades no
    <a href="https://whatsapp.com/channel/0029VakjTxcG8l5DQWBcKO3O" target="_blank">WhatsApp</a> ou
    <a href="https://t.me/+khy33-_eaUsxYjgx" target="_blank">Telegram</a>
  </div>


  <!-- TÍTULO -->
  <h1>🌀 Lançamentos</h1>

  <!-- CONTEÚDO -->
  <div class="episodios" id="feed"></div>
  <div id="pagination"></div>

  <!-- SCRIPT GOOGLE SHEETS COM PAGINAÇÃO -->
  <!-- SUBSTITUA ESTE SCRIPT PELO ANTERIOR -->
  <script>
    const sheetId = '1D3xgQNrlbiyYYcoNdPMd1_4o9NdgeSK41dPG-tSIomw';
    const sheetName = 'Página1';
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;

    let allRows = [];
    const itemsPerPage = 50;
    let currentPage = 1;

    function showError(msg) {
      const container = document.getElementById('feed');
      container.innerHTML = `<div style="color:#ff6b6b;padding:20px;text-align:center;background:#1b1b1b;border-radius:8px;">${msg}</div>`;
      document.getElementById('pagination').innerHTML = '';
    }

    function parseGViz(text) {
      // tenta extrair usando a função padrão do gviz
      const m = text.match(/google\.visualization\.Query\.setResponse\(([\s\S]*)\);/);
      if (m && m[1]) return JSON.parse(m[1]);
      // fallback: entre o primeiro "(" e o último ")"
      const start = text.indexOf('(');
      const end = text.lastIndexOf(')');
      if (start !== -1 && end !== -1) return JSON.parse(text.substring(start + 1, end));
      // última tentativa (antigo método)
      return JSON.parse(text.substr(47).slice(0, -2));
    }

    fetch(url)
      .then(res => {
        if (!res.ok) throw new Error('Resposta não OK: ' + res.status);
        return res.text();
      })
      .then(text => {
        let json;
        try {
          json = parseGViz(text);
        } catch (err) {
          console.error('Erro ao parsear JSON da planilha:', err);
          showError('Erro ao interpretar os dados da planilha. Verifique se a planilha está pública e se o ID/aba estão corretos.');
          return;
        }

        allRows = Array.isArray(json.table?.rows) ? json.table.rows.reverse() : [];
        if (allRows.length === 0) {
          showError('Planilha carregada, mas sem linhas (ou estrutura diferente).');
          return;
        }
        console.log('Planilha carregada. Linhas:', allRows.length);
        renderPage(currentPage);
      })
      .catch(err => {
        console.error('Erro no fetch da planilha:', err);
        showError('Erro ao carregar planilha: ' + err.message + '. Verifique conexão/permissões.');
      });

    function renderPage(page) {
      const container = document.getElementById('feed');
      const pagination = document.getElementById('pagination');
      container.innerHTML = '';
      pagination.innerHTML = '';

      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageItems = allRows.slice(start, end);

      pageItems.forEach(row => {
        const foto = row.c?.[0]?.v || 'https://j-s-fo.github.io/foto/anime/0.0.webp';
        const nome = row.c?.[1]?.v || 'Sem Nome';
        const ep = row.c?.[2]?.v ?? ''; // pode ser número, "Filme" ou vazio
        const idioma = row.c?.[3]?.v || '';
        const link = row.c?.[4]?.v || '#';
        const final = row.c?.[5]?.v === "Final" ? "Final" : "";

        const epStr = String(ep).trim();
        let titulo = '';
        if (epStr !== '' && epStr.toLowerCase() === 'filme') {
          titulo = `${nome} - Filme ${idioma}`.trim();
        } else if (epStr === '') {
          titulo = `${nome} ${final} - ${idioma}`.trim();
        } else {
          titulo = `${nome} - Episódio ${epStr} ${final} - ${idioma}`.trim();
        }

        const card = `
        <a href="${link}" target="_blank" rel="noopener">
          <div class="card">
            <img src="${foto}" alt="${nome}">
            <div class="card-content">
              <p class="titulo">${titulo}</p>
            </div>
          </div>
        </a>
      `;
        container.insertAdjacentHTML('beforeend', card);
      });

      const totalPages = Math.ceil(allRows.length / itemsPerPage);
      if (totalPages > 1) {
        if (page > 1) pagination.insertAdjacentHTML('beforeend', `<button onclick="renderPage(${page - 1})">◀ Anterior</button>`);
        let maxVisible = 6;
        let startPage = Math.max(1, page - Math.floor(maxVisible / 2));
        let endPage = startPage + maxVisible - 1;
        if (endPage > totalPages) {
          endPage = totalPages;
          startPage = Math.max(1, endPage - maxVisible + 1);
        }
        for (let i = startPage; i <= endPage; i++) {
          const style = i === page ? 'font-weight:bold;background:#00ffff;color:#000;' : '';
          pagination.insertAdjacentHTML('beforeend', `<button onclick="renderPage(${i})" style="${style}">${i}</button>`);
        }
        if (page < totalPages) pagination.insertAdjacentHTML('beforeend', `<button onclick="renderPage(${page + 1})">Próxima ▶</button>`);
      }

      document.querySelector('.menu').scrollIntoView({ behavior: 'smooth' });
    }
  </script>


  <div>
    <!-- Exemplo de inclusão do rodapé com JavaScript -->
    <script>
      fetch('footer.html')
        .then(response => response.text())
        .then(data => {
          document.body.insertAdjacentHTML('beforeend', data);
        });
    </script>
  </div>

</body>

</html>
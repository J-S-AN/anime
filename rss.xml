<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Feed RSS de Animes</title>
</head>
<body>
<pre id="rss-output"></pre>

<script>
const sheetId = '1D3xgQNrlbiyYYcoNdPMd1_4o9NdgeSK41dPG-tSIomw';
const sheetName = 'Página1'; // Nome da aba
const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

fetch(url)
  .then(res => res.text())
  .then(data => {
    const json = JSON.parse(data.substr(47).slice(0, -2));
    const rows = json.table.rows;

    const items = rows.map(row => {
      const foto = row.c[0]?.v || '';
      const nome = row.c[1]?.v || 'Sem Nome';
      const ep = row.c[2]?.v || '';
      const idioma = row.c[3]?.v || '';
      const link = row.c[4]?.v || '#';

      return `
<item>
  <title>${nome} - Episódio ${ep} (${idioma})</title>
  <link>${link}</link>
  <description><![CDATA[<img src="${foto}" width="320"><br><strong>${nome}</strong> - Episódio ${ep} (${idioma})]]></description>
</item>`;
    }).join('');

    const rss = `<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0">
<channel>
  <title>Feed de Animes</title>
  <link>https://j-s-an.github.io/anime/rss.xml</link>
  <description>Últimos episódios de animes</description>
  ${items}
</channel>
</rss>`;

    document.getElementById('rss-output').textContent = rss;
  });
</script>
</body>
</html>
